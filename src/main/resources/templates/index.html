<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org"
      xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <title>JTwitter</title>
</head>
<body>
<h1>Welcome!</h1>
<a sec:authorize="!isAuthenticated()" href="/login">Login</a><br/>
<a sec:authorize="!isAuthenticated()" href="/registration">Create an account</a><br/>
<table sec:authorize="isAuthenticated()">
    <tr>
        <td>Name:</td>
        <td th:text="${#authentication.getPrincipal().getFirstName()} + ' ' + ${#authentication.getPrincipal().getLastName()}"></td>
    </tr>
    <tr>
        <td>Username:</td>
        <td th:text="${#authentication.getPrincipal().getUsername()}"></td>
    </tr>
    <tr>
        <td>Email:</td>
        <td th:text="${#authentication.getPrincipal().getEmail()}"></td>
    </tr>
</table>
<table>
    <tr>
        <th>Time</th>
        <th>Text</th>
    </tr>
    <tr th:each="tweet : ${tweets}">
        <td><span th:text="${tweet.getCreatedAt()}"></span></td>
        <td><span th:text="${tweet.getText()}"></span></td>
    </tr>
</table>
<form sec:authorize="isAuthenticated()" method="post" action="/tweet">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
    <textarea name="text" required></textarea>
    <input type="submit" value="Post">
</form>
<form sec:authorize="isAuthenticated()" method="post" action="/logout">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
    <input type="submit" value="Logout">
</form>
</body>
</html>
